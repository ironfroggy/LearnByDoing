(function(){var LineRules=[];function newLineRule(obj){obj.execute=function(line){var starter=new RegExp("^[\t ]*\\b"+obj.token+"\\b");if(!starter.exec(line))return null;if(obj.inlineToken){var split=line.split(obj.inlineToken);if(split.length>=2&&split[1].match(/\w/))line+=" }"}if(typeof obj.expand[0]=="string")obj.expand=[obj.expand];for(var i=0;i<obj.expand.length;i++){var expander=obj.expand[i];var what=new RegExp(expander[0]);line=line.replace(what,expander[1])}return line};LineRules.push(obj);
return obj}newLineRule({token:"function",expand:[":","{"],dedent:"}",inlineToken:":"});newLineRule({token:"if",expand:[["if","if("],[":"," ){"]],dedent:"}",inlineToken:":"});newLineRule({token:"for",expand:[["for","for("],[":"," ){"]],dedent:"}",inlineToken:":"});function pyscript(){}pyscript.prototype={compile:function(input){this._indentLevel=0;this._onDedent=[];this._indentToken=null;this._predent="";var lines=input.split(/[\n\r]/g);this._predent=this.getPredentFromLines(lines);for(var i=0;i<lines.length;i++)lines[i]=
this.compileLine(lines[i]);if(this._onDedent.length>0)lines[lines.length-1]+=this._onDedent.join("");return lines.join("\n")},compileLine:function(line){line=this.removePredent(line);for(var i=0;i<LineRules.length;i++){var rule=LineRules[i];var result=rule.execute(line);if(result){line=result;break}}var indentLevel=this.getIndentLevel(line);if(indentLevel>this._indentLevel){this._indentLevel=indentLevel;this._onDedent.push(rule.dedent)}if(indentLevel<this._indentLevel){var diff=this._indentLevel-
indentLevel;this._indentLevel=indentLevel;for(var j=0;j<diff;j++)line+=this._onDedent.pop()}return this.addPredent(line)},getIndentLevel:function(line){var padding=line.match(/^[ \t]+/);if(!padding)return 0;if(!this._indentToken)this._indentToken=padding[0];var startWhiteSpace=line.split(/\b.*$/)[0];return startWhiteSpace.split(this._indentToken).length-1},getIndent:function(line){var indent=line.match(/^[ \t]+/);if(indent)return indent[0];return""},getPredentFromLines:function(lines){for(var i=0;i<
lines.length;i++){var possiblePredent=this.getIndent(lines[i]);if(possiblePredent&&possiblePredent.length>0)return possiblePredent;if(lines[i].match(/^\w/))return""}return""},removePredent:function(line){if(this._predent)return line.replace(new RegExp("^"+this._predent),"");return line},addPredent:function(line){if(this._predent&&line.length>0)return this._predent+line;return line}};function evalPyscript(){var compiler=new pyscript;var scripts=document.getElementsByTagName("script");for(var i=0;i<
scripts.length;i++)if(scripts[i].type.match("pyscript")){var s=document.createElement("script");s.innerHTML=compiler.compile(scripts[i].innerHTML);scripts[i].parentNode.replaceChild(s,scripts[i])}}if(typeof Event=="undefined")Event=new Object;Event.domReady={add:function(fn){if(Event.domReady.loaded)return fn();var observers=Event.domReady.observers;if(!observers)observers=Event.domReady.observers=[];observers[observers.length]=fn;if(Event.domReady.callback)return;Event.domReady.callback=function(){if(Event.domReady.loaded)return;
Event.domReady.loaded=true;if(Event.domReady.timer){clearInterval(Event.domReady.timer);Event.domReady.timer=null}var observers=Event.domReady.observers;for(var i=0,length=observers.length;i<length;i++){var fn=observers[i];observers[i]=null;fn()}Event.domReady.callback=Event.domReady.observers=null};var ie=!!(window.attachEvent&&!window.opera);var webkit=navigator.userAgent.indexOf("AppleWebKit/")>-1;if(document.readyState&&webkit)Event.domReady.timer=setInterval(function(){var state=document.readyState;
if(state=="loaded"||state=="complete")Event.domReady.callback()},50);else if(document.readyState&&ie){var src=window.location.protocol=="https:"?"://0":"javascript:void(0)";document.write('<script type="text/javascript" defer="defer" src="'+src+'" '+"onreadystatechange=\"if (this.readyState == 'complete') Event.domReady.callback();\""+"><\/script>")}else if(window.addEventListener){document.addEventListener("DOMContentLoaded",Event.domReady.callback,false);window.addEventListener("load",Event.domReady.callback,
false)}else if(window.attachEvent)window.attachEvent("onload",Event.domReady.callback);else{var fn=window.onload;window.onload=function(){Event.domReady.callback();if(fn)fn()}}}};window.Pyscript=new pyscript;window.Pyscript.eval=evalPyscript;window.Pyscript.getLineRule=function(token){for(var i=0;i<LineRules.length;i++)if(LineRules[i].token==token)return LineRules[i]};Event.domReady.add(function(){evalPyscript()})})();
